@model List<MenuItem>
@inject IMenuService _menuService
@{
    var userRole = User.IsInRole("admin") ? "admin" :
                  User.IsInRole("instructor") ? "instructor" :
                  User.IsInRole("student") ? "student" : "";
}

@* Kullanıcı rolüne göre sidebar sınıfı belirleme *@
@{
    var sidebarClass = userRole switch
    {
        "admin" => "bg-dark text-white",
        "instructor" => "bg-success text-white",
        "student" => "bg-primary text-white",
        _ => "bg-secondary text-white"
    };
}

<div class="sidebar position-fixed top-0 start-0 vh-100 d-flex flex-column @sidebarClass-sidebar">
	<div class="sidebar-header p-3 border-bottom">
        <h5 class="mb-0 text-white">
            @(userRole switch
            {
                "admin" => "Yönetim Paneli",
                "instructor" => "Eğitmen Paneli",
                "student" => "Öğrenci Paneli",
                _ => "Panel"
            })
        </h5>
	</div>

<div class="sidebar-container @userRole-sidebar">
	<div class="sidebar-header p-3 my-2">
		<h5 class="mb-0 text-white">
			@(userRole switch
			{
				"admin" => "Yönetim Paneli",
				"instructor" => "Eğitmen Paneli",
				"student" => "Öğrenci Paneli",
				_ => "Panel"
			})
		</h5>
	</div>

	<div class=" flex-grow-1 overflow-auto sidebar-narrow-unfoldable">
		<ul class="nav flex-column">
			@foreach (var item in Model)
			{
				if (item.SubMenuItems.Any())
				{
					<li class="nav-item">
						<a class="nav-link text-white d-flex align-items-center my-1 @(item.IsActive ? "active bg-opacity-25" : "")"
						   data-bs-toggle="collapse" href="#@item.Name.Replace(" ", "")">
							<i class="@item.Icon me-2"></i> @item.Name
							<i class="bi bi-chevron-down ms-auto"></i>
						</a>
						<div class="collapse @(item.IsActive || item.SubMenuItems.Any(sm => sm.IsActive) ? "show" : "")" id="@item.Name.Replace(" ", "")">
							<ul class="nav flex-column ms-3">
								@foreach (var subItem in item.SubMenuItems)
								{
									<li class="nav-item">
										<a class="nav-link text-white w-100 text-wrap @(subItem.IsActive ? "active bg-opacity-25" : "")" href="@_menuService.GetMenuUrl(subItem)">
											<i class="@subItem.Icon me-2"></i> @subItem.Name
										</a>
									</li>
								}
							</ul>
						</div>
					</li>
				}
				else
				{
					<li class="nav-item">
						<a class="nav-link text-white my- @(item.IsActive ? "active bg-opacity-25" : "")" href="@_menuService.GetMenuUrl(item)">
							<i class="@item.Icon me-2"></i> @item.Name
						</a>
					</li>
				}
			}
		</ul>
		

	</div>
	<div class="btn-group dropup sidebar-footer p-3 border-top w-100">
	
		<a class="btn btn-danger w-100 d-flex align-items-center justify-content-center" asp-controller="Member" asp-action="Logout">
			<i class="bi bi-box-arrow-right me-2"></i>
			Çıkış Yap
		</a>

		<button type="button" class="btn btn-outline-danger dropdown-toggle dropdown-toggle-split " data-bs-toggle="dropdown" aria-expanded="false">
			<span class="visually-hidden">Toggle Dropdown</span>
		</button>

		<ul class="dropdown-menu ">
			<li>
				<a class="dropdown-item bg-dark-subtle text-white" asp-controller="Member" asp-action="UserEdit">
					<i class="bi bi-person-gear me-2"></i> Profil Düzenle
				</a>
			</li>
			<li>
				<a class="dropdown-item bg-dark-subtle text-white" asp-controller="Member" asp-action="Logout">
					<i class="bi bi-box-arrow-right me-2"></i> Çıkış Yap
				</a>
			</li>
		</ul>
	</div>
	
</div>
</div>
